      SUBROUTINE LIRAF(NDIM,KDIM,NTOT,N,KTOT,K,KVVP,NGRAF,NPAGE,
     1                 NLIGN,PEX,F,KODI,KODJ,IDI,IDJ)
      COMMON /ENSOR/LEC,IMP
      DIMENSION F(NDIM,KDIM),IDI(NDIM),IDJ(KDIM)
      DIMENSION KODI(NDIM),KODJ(KDIM),FMT(20)
      IUNIT=8
      READ(LEC,500) NTOT,N,KTOT,K
      WRITE(IMP,610) NTOT,N,KTOT,K
      DO 5 I=1,NTOT
5     KODI(I)=I
      DO 6 J=1,KTOT
6     KODJ(J)=J
      IF (NTOT.EQ.N) GOTO 10
      READ(LEC,520) (KODI(I),I=1,NTOT)
      WRITE(IMP,630) (KODI(I),I=1,NTOT)
10    IF (KTOT.EQ.K) GOTO 20
      READ(LEC,520) (KODJ(J),J=1,KTOT)
      WRITE(IMP,640) (KODJ(J),J=1,KTOT)
20    CONTINUE
      READ(LEC,510) KVVP,NGRAF,NPAGE,NLIGN,PEX
      IF (NGRAF.GT.(KVVP-1)) NGRAF=KVVP-1
      WRITE(IMP,620) KVVP,NGRAF,NPAGE,NLIGN,PEX
      READ(LEC,530) (IDJ(J),J=1,KTOT)
      READ(LEC,530) (FMT(L),L=1,20)
      WRITE(IMP,650) (FMT(L),L=1,20)
      DO 30 I=1,NTOT
30    READ(IUNIT,FMT) IDI(I),(F(I,J),J=1,KTOT)
      RETURN
500   FORMAT(6I4)
510   FORMAT(4I4,F4.1)
520   FORMAT(80I1)
530   FORMAT(20A4)
610   FORMAT(1H0,14HLIGNES  NTOT =,I4,5H  N =,I4,10X,8HCOLONNES,
     1       8H  KTOT =,I4,5H  K =,I4/)
620   FORMAT(1H0,38HPARAMETRES/KVVP NGRAF NPAGE NLIGN PEX/10X,4I5,F5.1)
630   FORMAT(1H0,39HLIGNES ACTIVES (1) OU ILLUSTRATIVES (0) /
     1       1H ,100I1/1H ,100I1)
640   FORMAT(1H0,41HCOLONNESACTIVES (1) OU ILLUSTRATIVES (0) /
     1       1H ,100I1/1H ,100I1/)
650   FORMAT(1H0,17HFORMAT DE LECTURE,10X,20A4/)
      END
