	SUBROUTINE AIDAC (MDIM,NDIM,KDIM,N,K,KVVP,KFAC,KOL,F,IDI,IDJ,
     1			   U,V,KODI,KODJ,FI,FJ,ID)
	COMMON /ENSOR/LEC,IMP
	DIMENSION F(NDIM,KDIM),U(NDIM,KFAC),V(KDIM,KFAC)
	DIMENSION IDI(NDIM),IDJ(KDIM),ID(MDIM)
	DIMENSION KODI(NDIM),KODJ(KDIM),FI(NDIM),FJ(KDIM)
	DO 10 I=1,N
10	FI(I)=U(I,KOL)
	CALL SHELK (N,FI,ID)
	DO 20 I=1,N
	KK=ID(I)
	ID(I)=IDI(KK)
20	KODI(KK)=I
	DO 30 I=1,N
30	IDI(I)=ID(I)
	DO 40 J=1,K
40	FJ(J)=V(J,KOL)
	CALL SHELK (K,FJ,ID)
	DO 50 J=1,K
	KK=ID(J)
	ID(J)=IDJ(KK)
50	KODJ(KK)=J
	DO 60 J=1,K
60	IDJ(J)=ID(J)
	CALL PERMX (NDIM,KDIM,N,K,F,KODI,KODJ)
	KPT=0
	DO 70 I=1,N
	FI(I)=0.0
	DO 70 J=1,K
70	FI(I)=FI(I)+F(I,J)
	DO 80 J=1,K
	FJ(J)=0.0
	DO 80 I=1,N
80	FJ(J)=FJ(J)+F(I,J)
	DO 90 J=1,K
	DO 90 I=1,N
90	F(I,J)=(F(I,J)*1000.0)/FI(I)
	WRITE (IMP,600)
	KODK=3
	GOTO 120
100	CONTINUE
	DO 110 J=1,K
	DO 110 I=1,N
110	F(I,J)=(F(I,J)/FJ(J))*FI(I)
	WRITE (IMP,610)
120	KPT=KPT+1
	CALL KLICO (KODK,NDIM,KDIM,N,K,F,IDI,IDJ)
	IF (KPT.EQ.1) GOTO 100
600	FORMAT (1H1/1H0,40X,33HDONNEES RANGEES SUR LE FACTEUR 1   //
     1	     1H ,32X,44HPROFILS DES LIGNES (SOMME D'UNE LIGNE=1000)  )
610	FORMAT (1H1/1H0,40X,33HDONNEES RANGEES SUR LE FACTEUR 1   //
     1	     1H ,34X,48HPROFILS DES COLONNES (SOMME D'UNE COLONNE=1000) )
	RETURN
	END
