C********************************************
C     ANALYSE EN COMPOSANTES PRINCIPALES
C********************************************
      PARAMETER (NDIM=1000,KDIM=300,KFAC=20,MDIM=1301)
      DIMENSION F(NDIM,KDIM),S(KDIM,KDIM),VP(KDIM),U(NDIM,KFAC)
     1         ,V(KDIM,KFAC)
      DIMENSION FI(NDIM),KODI(NDIM),DI(NDIM)
      DIMENSION FJ(KDIM),KODJ(KDIM)
      DIMENSION X(MDIM),Y(MDIM)
      DIMENSION IDI(NDIM),IDJ(KDIM),ID(MDIM)
      COMMON /ENSOR/LEC,IMP
      LEC=5
      IMP=6
      WRITE(IMP,600) NDIM,KDIM,MDIM,KFAC
      CALL LIRAF(NDIM,KDIM,NTOT,N,KTOT,K,KVVP,NGRAF,NPAGE,NLIGN,PEX,
     1           F,KODI,KODJ,IDI,IDJ)
      IF (NTOT.EQ.N.AND.KTOT.EQ.K) GOTO 10
      CALL POUSS(MDIM,NDIM,KDIM,NTOT,KTOT,N,K,KODI,KODJ,F,IDI,IDJ,ID)
10    WRITE(IMP,620)
      MODK=2
      CALL KLICO(MODK,NDIM,KDIM,NTOT,KTOT,F,IDI,IDJ)
      CALL CALFP(NDIM,KDIM,NTOT,N,KTOT,K,KVVP,KFAC,F,FI,FJ,
     1           S,VP,U,V,DI,IDJ)
      VPTOT=K
      MODV=1
      CALL EDIVP(KDIM,MODV,K,VP,VPTOT)
      CALL COORP(NDIM,KDIM,KFAC,NTOT,N,KTOT,K,KVVP,U,V,FI,FJ,IDI,IDJ)
      IF (NGRAF.LE.0) GOTO 50
      JX=1
      DO 40 NG=1,NGRAF
      JY=JX+1
      IF (JY.GT.KVVP) GOTO 50
      DO 20 I=1,NTOT
      X(I)=U(I,JX)
      Y(I)=U(I,JY)
20    ID(I)=IDI(I)
      DO 30 J=1,KTOT
      I1=NTOT+J
      X(I1)=V(J,JX)
      Y(I1)=V(J,JY)
30    ID(I1)=IDJ(J)
      MTOT=NTOT+KTOT
      CALL GPLAN(MDIM,MTOT,JX,JY,X,Y,ID,4,NLIGN,NPAGE,PEX,1)
40    JX=JY
50    CONTINUE
      WRITE(IMP,610)
      STOP
600   FORMAT(1H1/1H0,130(1H-)/1H ,50X,23HCOMPOSANTES PRINCIPALES /
     1       1H /130(1H-)/1H0/1H 24H MAJORANT DE NTOT  NDIM=,I4,17X,
     2   23HMAJORANT DE KTOT  KDIM=,I4/1H ,
     3   30HMAJORANT DE NTOT+KTOT+1  MDIM=,I4,10X,
     4   23HMAJORANT DE KVVP  KFAC=,I4/)
610   FORMAT(1H1/1H0,130(1H-)//1H ,58X,17HFIN DU TRAITEMENT //
     1       1H ,130(1H-)/)
620   FORMAT(1H1/1H0,10X,'TABLEAU DES DONNEES BRUTES ', 
     1       '(EVENTUELLEMENT PERMUTEES)')
      END
